<div class="container well">
  <p>
    <strong>Name:</strong>
    <%= @dg_league.name %>
  </p>

  <p>
    <strong>Address:</strong>
    <%= @dg_league.league_address %>
  </p>

  <p>
    <strong>Description:</strong>
    <%= @dg_league.description %>
  </p>

  <p>
    <strong>Par:</strong>
    <%= @dg_league.par %>
  </p>
</div>
<% if @games.length > 0 %>
  <div class="container well">
    <h3>Last Games's Results - <%= @games.last.start_date.strftime("%B %d, %Y")  %></h3>
    <div class="row-fluid">
      <div class="col-xs-4">
        <h4>Top Adjusted Scores</h4>
        <dl class="dl-horizontal">
        <% @score_array.sort {|a,b| a.adjusted_score <=> b.adjusted_score}.each do |score| %>
          <dt><%= score.player.name %>:</dt>
          <dd><%= score.adjusted_score %></dd>
        <% end %>
        </dl>
      </div>
      <div class="col-xs-4">
        <h4>Top Scratch Scores</h4>
        <dl class="dl-horizontal">
        <% @score_array.sort {|a,b| a.value <=> b.value}.each do |score| %>
          <dt><%= score.player.name %>:</dt>
          <dd><%= score.value %></dd>
        <% end %>
        </dl>
      </div>
      <div class="col-xs-4">
        <h4>CTPs</h4>
        <dl class="dl-horizontal">
        <% @games.last.ctps.uniq.sort {|a,b| a.hole <=> b.hole}.each do |ctp| %>
          <dt><%= ctp.player.name %>:</dt>
          <dd><%= ctp.hole %></dd>
        <% end %>
        </dl>
      </div>
    </div>
  </div>

  <div class="container well">
    <h3> League Players</h3>
    <table class="table">
      <thead>
        <tr>
          <th class = "col-xs-3">Player name</th>
          <th class = "col-xs-2">Handicap</th>
          <th class = "col-xs-2">Best Round</th>
          <th class = "col-xs-4">Last 6 Scratch Scores</th>
          <th class = "col-xs-1"></th>
          <% if current_user %>
            <th class = "col-xs-1"><%= link_to icon('plus'), new_player_path, class: "btn btn-success" %></th>
          <% end %>
        </tr>
      </thead>

      <tbody>
        <% @dg_league.players.uniq.each do |player| %>
          <tr>
            <td class="col-xs-3"><%= link_to player.name, player %></td>
            <td class = "col-xs-2"><%= player.calc_handicap(Date.today, @dg_league.id) %></td>
            <td class = "col-xs-2"><%= player.best_score(Date.today, @dg_league.id) %></td>
            <td class = "col-xs-1"><%= player.last_scores(Date.today, @dg_league.id, 6).join(" | ") %></td>
            <% if current_user %>
              <td class="col-xs-1"><%= link_to icon('pencil'), edit_player_path(player), class: "btn btn-info" %></td>
              <td class="col-xs-1"><%= link_to icon('trash-o') , player, method: :delete, data: { confirm: 'Are you sure you want to delete this player?' },  class: "btn btn-danger" %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="container well">
      <h3> Previous Games</h3>
      <table class="table">
        <thead>
          <tr>
            <th class = "col-xs-3">Date</th>
            <th class = "col-xs-8">League</th>
            <th class = "col-xs-1"></th>
            <% if current_user %>
              <th class = "col-xs-1"><%= link_to icon('plus'), 'games/new', class: "btn btn-success" %></th>
            <% end %>
          </tr>
        </thead>

        <tbody>
          <% @dg_league.games.sort {|a,b| b.start_date <=> a.start_date}.each do |game| %>
            <tr>
              <td class="col-xs-3"><%= link_to game.start_date.strftime("%B %d, %Y"), game %></td>
              <td class="col-xs-8"><%= game.dg_league.name%></td>
              <% if current_user %>
                <td class="col-xs-1"><%= link_to icon('pencil'), edit_game_path(game), class: "btn btn-info" %></td>
                <td class="col-xs-1"><%= link_to icon('trash-o') , game, method: :delete, data: { confirm: 'Are you sure you want to delete this game?' },  class: "btn btn-danger" %></td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>